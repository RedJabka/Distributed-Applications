# Distributed-Applications-lab2 
### «Распределенная банковская система»
## Постановка задачи
За основу банковской системы необходимо взять модель распределенной системы,
описанную в условии к первой лабораторной работе. Разделяют два типа процессов,
составляющих банковскую систему:

• процессы, принимающие запросы от клиентов (тип «К»);
• процессы, отвечающие за обслуживание счетов (тип «С»).

В данной лабораторной работе используется один процесс типа «К» и N – 1
процессов типа «C». Каждый процесс имеет собственные физические часы. Процессы
обмениваются сообщениями в асинхронном режиме.
Процесс «К» на основе запросов клиента формирует запросы к соответствующим
процессам «С». Поддерживаются следующие операции:

• перевод денег между счетами;
• получение информации об истории изменения баланса.

При переводе денег процесс «K» отправляет сообщение процессу «Сsrc», с которого
осуществляется списание. Процесс «Csrc» после выполнения требуемых операций
пересылает исходное сообщение процессу «Сdst». Процесс «Сdst» после выполнения всех
необходимых действий отправляет процессу «K» подтверждение о выполнении операции.
Предполагается, что используются корректные запросы на перевод и каналы надежные,
поэтому другие подтверждения о выполнении операций не требуются.

## Задание
В реализации банковской системы из предыдущего задания необходимо
заменить физическое время на скалярное время Лэмпорта. Для обмена отметками времени
процессы должны использовать поле s_local_time структуры MessageHeader, которое
должно содержать показания часов процесса-отправителя на момент отправки сообщения.
Получение текущей отметки времени осуществляется посредством вызова функции
get_lamport_time(), которую необходимо реализовать.
Логические часы инициализируются нулем. Считать, что у процессов отсутствуют
внутренние события, т.е. линейному упорядочиванию подлежат только события отправки
и получения сообщений. Перед выполнением любого события процесс увеличивает
показания своих логических часов на единицу. Так при отправке сообщения показания
часов сначала увеличиваются, а уже потом в сообщение вкладывается отметка времени.
Отправка группового сообщения посредством функции send_multicast() продвигает время
на единицу вне зависимости от числа отправленных сообщений. В случае, когда два
события имеют одинаковые временные метки, линейный порядок определяется на основе
идентификаторов процессов, в которых произошли данные события.
В отличие от предыдущего задания при подсчете полной суммы денег в каждый
момент времени необходимо учитывать состояние каналов между процессами, т.е.
сохранять информацию о переводах, которые были отправлены, но еще не были
получены. Для этого необходимо заполнять поле s_balance_pending_in структуры
BalanceState. Обратите внимание, что в виду синхронности протокола данная задача
является упрощенным вариантом задачи подсчета полной суммы, рассмотренной на
лекции.
Никакие другие изменения в банковскую систему вносить не требуется.
